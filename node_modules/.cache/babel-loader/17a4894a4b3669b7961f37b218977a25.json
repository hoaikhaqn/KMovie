{"ast":null,"code":"import _slicedToArray from \"/home/h/Source/Project/movie-website/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/h/Source/Project/movie-website/src/views/Movies/index.js\";\nimport React, { useEffect, useState } from \"react\";\nimport ReactPaginate from 'react-paginate'; // import { Link } from 'react-router-dom';\n\nimport { select } from 'reactstrap';\nimport { useReduceState } from \"../../context\";\nimport \"./style.css\";\nimport $ from \"jquery\"; //Components\n\nimport Breadcrumbs from \"../../containers/DefaultLayout/DefaultBreadcrumbs\";\nimport SideBar from \"../../components/Sidebar\";\nimport VideoItem from \"../../components/VideoItem\";\n\nvar _ = require('lodash');\n\nvar reset = false;\nexport default function MoviePage(props) {\n  const _useReduceState = useReduceState(),\n        state = _useReduceState.state,\n        firebase = _useReduceState.firebase,\n        getCollection = _useReduceState.getCollection;\n\n  const _useState = useState(),\n        _useState2 = _slicedToArray(_useState, 2),\n        type = _useState2[0],\n        setType = _useState2[1];\n\n  const _useState3 = useState(),\n        _useState4 = _slicedToArray(_useState3, 2),\n        genres = _useState4[0],\n        setGenres = _useState4[1];\n\n  const _useState5 = useState(),\n        _useState6 = _slicedToArray(_useState5, 2),\n        nation = _useState6[0],\n        setNation = _useState6[1];\n\n  const _useState7 = useState(),\n        _useState8 = _slicedToArray(_useState7, 2),\n        year = _useState8[0],\n        setYear = _useState8[1];\n\n  const _useState9 = useState(),\n        _useState10 = _slicedToArray(_useState9, 2),\n        params = _useState10[0],\n        setParams = _useState10[1];\n\n  const _useState11 = useState(),\n        _useState12 = _slicedToArray(_useState11, 2),\n        keyword = _useState12[0],\n        setKeyword = _useState12[1];\n\n  const _useState13 = useState(),\n        _useState14 = _slicedToArray(_useState13, 2),\n        filter = _useState14[0],\n        setFilter = _useState14[1];\n\n  const _useState15 = useState(),\n        _useState16 = _slicedToArray(_useState15, 2),\n        breadcrumb = _useState16[0],\n        setBreadcrumb = _useState16[1];\n\n  const onFilter = event => {\n    var ftype = document.getElementById(\"type\").value;\n    var fgenre = document.getElementById(\"genre\").value;\n    var fnation = document.getElementById(\"nation\").value;\n    var fyear = document.getElementById(\"year\").value;\n\n    if (ftype == 'all-type' && fgenre != 'all-genre') {\n      props.history.push(\"/the-loai/\".concat(fgenre, \"/\").concat(fnation, \"/\").concat(fyear));\n    } else if (ftype == 'all-type' && fnation != 'all-nation') {\n      props.history.push(\"/quoc-gia/\".concat(fnation, \"/\").concat(fyear));\n    } else if (ftype == 'all-type' && fyear != 'all-year') {\n      props.history.push(\"/phim-nam/\".concat(fyear));\n    } else {\n      props.history.push(\"/loai/\".concat(ftype, \"/\").concat(fgenre, \"/\").concat(fnation, \"/\").concat(fyear));\n    }\n  };\n\n  const onSort = event => {\n    setFilter([]);\n    var sort = event.target.value;\n    var dataUpdated = filter.sort(function (a, b) {\n      return b[sort] - a[sort];\n    });\n    setTimeout(() => {\n      setFilter(dataUpdated);\n    }, 100);\n  };\n\n  const onChangePage = data => {\n    let selected = data.selected;\n    let offset = Math.ceil(selected * 4);\n    console.log(offset);\n\n    for (let i = 0; i < array.length; i++) {\n      const element = array[i];\n    } // var dataUpdated = filter.sort(function (a, b) {\n    //   return b[sort] - a[sort];\n    // })\n\n  };\n\n  if (!keyword && props.match.params.keyword) {\n    reset = true;\n    $(\".zmoto-products\").removeClass(\"fadeIn\");\n    setKeyword(props.match.params.keyword);\n  }\n\n  if (!params || !_.isEqual(params, props.match.params)) {\n    reset = true;\n    $(\".zmoto-products\").removeClass(\"fadeIn\");\n    setParams(props.match.params);\n  }\n\n  if (!state.data || state.data && !state.data.year) {\n    getCollection(\"year\", {\n      limit: 5\n    });\n  }\n\n  useEffect(() => {\n    if (!type) {\n      setType(state.data && state.data.type);\n    }\n\n    if (!genres) {\n      setGenres(state.data && state.data.genre);\n    }\n\n    if (!nation) {\n      setNation(state.data && state.data.nation);\n    }\n\n    if (!year) {\n      setYear(state.data && state.data.year);\n    }\n\n    console.log(params);\n\n    if (type && genres && nation && year && params && reset) {\n      var aCondition = [];\n      var aBreadcrumb = [];\n\n      if (params.type && params.type != 'all-type') {\n        let obj = _.find(type, {\n          id: params.type\n        });\n\n        if (obj) {\n          aCondition.push([\"type\", obj]);\n          aBreadcrumb.push({\n            url: \"/\".concat(obj.id),\n            label: obj.name\n          });\n        }\n      }\n\n      if (params.genre && params.genre != 'all-genre') {\n        let obj = _.find(genres, {\n          id: params.genre\n        });\n\n        if (obj) {\n          aCondition.push([\"genre\", obj]);\n          aBreadcrumb.push({\n            url: \"/the-loai/\".concat(obj.id),\n            label: obj.name\n          });\n        }\n      }\n\n      if (params.nation && params.nation != 'all-nation') {\n        let obj = _.find(nation, {\n          id: params.nation\n        });\n\n        if (obj) {\n          aCondition.push([\"nation\", obj]);\n          aBreadcrumb.push({\n            url: \"/quoc-gia/\".concat(obj.id),\n            label: obj.name\n          });\n        }\n      }\n\n      if (params.year && params.year != 'all-year') {\n        aCondition.push([\"year\", params.year]);\n        aBreadcrumb.push({\n          url: \"/phim-nam/\".concat(params.year),\n          label: \"Phim \".concat(params.year)\n        });\n      }\n\n      if (aCondition.length) {\n        firebase.getDocWithMultiCondition(\"movie\", {\n          where: aCondition,\n          orderBy: [\"createdAt\", \"desc\"],\n          limit: 10\n        }, setFilter);\n        reset = false;\n      }\n\n      setBreadcrumb(aBreadcrumb);\n    }\n\n    if (keyword && reset) {\n      firebase.getDocWithKeyword(\"movie\", {\n        where: [[\"keywords CONTAINS '\".concat(props.match.params.keyword.replace(/ /g, \"%20\"), \"'\")], [\"tags CONTAINS '\".concat(props.match.params.keyword.replace(/ /g, \"%20\"), \"'\")]]\n      }, setFilter);\n      reset = false;\n    }\n  }); // console.log(\"RESET\",reset)\n  // console.log(\"filterf\",filter)\n\n  if (!reset && filter) {\n    console.log(filter);\n    $(\".main-page\").addClass(\"fadeIn\");\n    $(\".zmoto-products\").addClass(\"fadeIn\");\n  }\n\n  return React.createElement(\"div\", {\n    id: \"MoviePage\",\n    className: \"main-page fadeOut\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147\n    },\n    __self: this\n  }, props.match.params.keyword ? React.createElement(Breadcrumbs, {\n    items: [\"T\\u1EEB kh\\xF3a: \".concat(props.match.params.keyword)],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150\n    },\n    __self: this\n  }) : React.createElement(Breadcrumbs, {\n    items: breadcrumb,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"zmoto-inner-page\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"zmovo-product-page\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"zmovo-product-items\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"zmovo-product-items-inner\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"row\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col-12\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"zmovo-product-with-sedbar\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"row\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col-lg-9\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"product-filter mb-30\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"product-filter-inner\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"product-filter-list\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"short-by-show form-inline2\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"row\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col-6 col-sm-4 col-md-3 col-lg-2\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"short-by\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171\n    },\n    __self: this\n  }, React.createElement(\"select\", {\n    type: \"select\",\n    id: \"sort\",\n    onChange: onSort,\n    className: \"selectpicker\",\n    \"data-live-search\": \"true\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172\n    },\n    __self: this\n  }, React.createElement(\"option\", {\n    value: \"\",\n    hidden: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173\n    },\n    __self: this\n  }, \"S\\u1EAFp x\\u1EBFp\"), React.createElement(\"option\", {\n    value: \"createdAt\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174\n    },\n    __self: this\n  }, \"M\\u1EDBi nh\\u1EA5t\"), React.createElement(\"option\", {\n    value: \"imdb\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175\n    },\n    __self: this\n  }, \"Top IMDb\"), React.createElement(\"option\", {\n    value: \"view\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176\n    },\n    __self: this\n  }, \"L\\u01B0\\u1EE3t xem\"), React.createElement(\"option\", {\n    value: \"rating\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177\n    },\n    __self: this\n  }, \"Top \\u0111\\xE1nh gi\\xE1\")))), type ? React.createElement(\"div\", {\n    className: \"col-6 col-sm-4 col-md-3 col-lg-2\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"pro-show\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184\n    },\n    __self: this\n  }, React.createElement(\"select\", {\n    type: \"select\",\n    id: \"type\",\n    className: \"selectpicker\",\n    defaultValue: params && params.type,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185\n    },\n    __self: this\n  }, React.createElement(\"option\", {\n    value: \"all-type\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186\n    },\n    __self: this\n  }, \"--Lo\\u1EA1i--\"), type.map(function (item, key) {\n    return React.createElement(\"option\", {\n      key: key,\n      value: item.id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, item.name);\n  })))) : \"\", genres ? React.createElement(\"div\", {\n    className: \"col-6 col-sm-4 col-md-3 col-lg-2\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"pro-show\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200\n    },\n    __self: this\n  }, React.createElement(\"select\", {\n    type: \"select\",\n    id: \"genre\",\n    className: \"selectpicker\",\n    defaultValue: params && params.genre ? params.genre : props.match.params.genre || 0,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201\n    },\n    __self: this\n  }, React.createElement(\"option\", {\n    value: \"all-genre\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202\n    },\n    __self: this\n  }, \"--Th\\u1EC3 lo\\u1EA1i--\"), genres.map(function (item, key) {\n    return React.createElement(\"option\", {\n      key: key,\n      value: item.id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    }, item.name);\n  })))) : \"\", nation ? React.createElement(\"div\", {\n    className: \"col-6 col-sm-4 col-md-3 col-lg-2\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"pro-show\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215\n    },\n    __self: this\n  }, React.createElement(\"select\", {\n    type: \"select\",\n    id: \"nation\",\n    className: \"selectpicker\",\n    defaultValue: params && params.nation ? params.nation : props.match.params.nation || 0,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216\n    },\n    __self: this\n  }, React.createElement(\"option\", {\n    value: \"all-nation\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217\n    },\n    __self: this\n  }, \"--Qu\\u1ED1c gia--\"), nation.map(function (item, key) {\n    return React.createElement(\"option\", {\n      key: key,\n      value: item.id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220\n      },\n      __self: this\n    }, item.name);\n  })))) : \"\", year ? React.createElement(\"div\", {\n    className: \"col-6 col-sm-4 col-md-3 col-lg-2\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"pro-show\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229\n    },\n    __self: this\n  }, React.createElement(\"select\", {\n    type: \"select\",\n    id: \"year\",\n    className: \"selectpicker\",\n    defaultValue: params && params.year ? params.year : props.match.params.year,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230\n    },\n    __self: this\n  }, React.createElement(\"option\", {\n    value: \"all-year\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231\n    },\n    __self: this\n  }, \"--N\\u0103m--\"), year.map(function (item, key) {\n    return React.createElement(\"option\", {\n      key: key,\n      value: item.id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234\n      },\n      __self: this\n    }, item.id);\n  })))) : \"\", React.createElement(\"div\", {\n    className: \"col-6 col-sm-4 col-md-3 col-lg-2\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"pro-show\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    className: \"btn btn-buttons btn-sm btn-fit\",\n    onClick: onFilter,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243\n    },\n    __self: this\n  }, \"L\\u1ECDc phim\")))))))), React.createElement(\"div\", {\n    className: \"zmoto-products fadeOut\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"zmovo-product-list\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"row\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254\n    },\n    __self: this\n  }, filter && filter.map(function (item, key) {\n    return React.createElement(\"div\", {\n      key: key,\n      className: \"col-lg-3 col-md-4 col-xs-6\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"item\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259\n      },\n      __self: this\n    }, React.createElement(VideoItem, {\n      data: item,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260\n      },\n      __self: this\n    })));\n  })))), React.createElement(\"div\", {\n    className: \"product-filter\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"product-filter-inner\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"product-filter-list\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 271\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"pagination-wrapper\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 272\n    },\n    __self: this\n  }, React.createElement(\"nav\", {\n    \"aria-label\": \"navigations\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 275\n    },\n    __self: this\n  }, React.createElement(ReactPaginate, {\n    previousLabel: '<',\n    nextLabel: '>',\n    previousClassName: 'page-item',\n    nextClassName: 'page-item',\n    previousLinkClassName: 'page-link pagefirst',\n    nextLinkClassName: 'page-link lastpage',\n    breakLabel: '...',\n    breakClassName: 'page-item break-me',\n    containerClassName: 'pagination',\n    pageClassName: 'page-item',\n    pageLinkClassName: 'page-link',\n    activeClassName: 'active',\n    pageCount: filter && filter.length / 4,\n    marginPagesDisplayed: 2,\n    pageRangeDisplayed: 5,\n    onPageChange: onChangePage,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 281\n    },\n    __self: this\n  }))))))), React.createElement(\"div\", {\n    className: \"col-lg-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 308\n    },\n    __self: this\n  }, React.createElement(SideBar, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 309\n    },\n    __self: this\n  }))))))))))));\n}","map":{"version":3,"sources":["/home/h/Source/Project/movie-website/src/views/Movies/index.js"],"names":["React","useEffect","useState","ReactPaginate","select","useReduceState","$","Breadcrumbs","SideBar","VideoItem","_","require","reset","MoviePage","props","state","firebase","getCollection","type","setType","genres","setGenres","nation","setNation","year","setYear","params","setParams","keyword","setKeyword","filter","setFilter","breadcrumb","setBreadcrumb","onFilter","event","ftype","document","getElementById","value","fgenre","fnation","fyear","history","push","onSort","sort","target","dataUpdated","a","b","setTimeout","onChangePage","data","selected","offset","Math","ceil","console","log","i","array","length","element","match","removeClass","isEqual","limit","genre","aCondition","aBreadcrumb","obj","find","id","url","label","name","getDocWithMultiCondition","where","orderBy","getDocWithKeyword","replace","addClass","map","item","key"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport ReactPaginate from 'react-paginate';\n// import { Link } from 'react-router-dom';\nimport { select } from 'reactstrap';\nimport { useReduceState } from \"../../context\";\nimport \"./style.css\";\nimport $ from \"jquery\";\n\n//Components\nimport Breadcrumbs from \"../../containers/DefaultLayout/DefaultBreadcrumbs\";\nimport SideBar from \"../../components/Sidebar\";\nimport VideoItem from \"../../components/VideoItem\";\n\nvar _ = require('lodash');\nvar reset = false;\nexport default function MoviePage(props) {\n  const { state, firebase, getCollection } = useReduceState();\n  const [type, setType] = useState();\n  const [genres, setGenres] = useState();\n  const [nation, setNation] = useState();\n  const [year, setYear] = useState();\n  const [params, setParams] = useState();\n  const [keyword, setKeyword] = useState();\n  const [filter, setFilter] = useState();\n  const [breadcrumb, setBreadcrumb] = useState();\n\n  const onFilter = event => {\n    var ftype = document.getElementById(\"type\").value;\n    var fgenre = document.getElementById(\"genre\").value;\n    var fnation = document.getElementById(\"nation\").value;\n    var fyear = document.getElementById(\"year\").value;\n\n    if (ftype == 'all-type' && fgenre != 'all-genre') {\n      props.history.push(`/the-loai/${fgenre}/${fnation}/${fyear}`)\n    }\n    else if (ftype == 'all-type' && fnation != 'all-nation') {\n      props.history.push(`/quoc-gia/${fnation}/${fyear}`)\n    }\n    else if (ftype == 'all-type' && fyear != 'all-year') {\n      props.history.push(`/phim-nam/${fyear}`)\n    }\n    else {\n      props.history.push(`/loai/${ftype}/${fgenre}/${fnation}/${fyear}`)\n    }\n  };\n  const onSort = event => {\n    setFilter([]);\n    var sort = event.target.value;\n    var dataUpdated = filter.sort(function (a, b) {\n      return b[sort] - a[sort];\n    })\n    setTimeout(() => {\n      setFilter(dataUpdated);\n    }, 100);\n  };\n  const onChangePage = data =>{\n    let selected = data.selected;\n    let offset = Math.ceil(selected * 4);\n    console.log(offset)\n    for (let i = 0;i < array.length; i++) {\n      const element = array[i];\n      \n    }\n    // var dataUpdated = filter.sort(function (a, b) {\n    //   return b[sort] - a[sort];\n    // })\n  }\n  if (!keyword && props.match.params.keyword) {\n    reset = true;\n    $(\".zmoto-products\").removeClass(\"fadeIn\");\n    setKeyword(props.match.params.keyword);\n  }\n  if (!params || !_.isEqual(params, props.match.params)) {\n    reset = true;\n    $(\".zmoto-products\").removeClass(\"fadeIn\");\n    setParams(props.match.params);\n  }\n\n  if (!state.data || (state.data && !state.data.year)) {\n    getCollection(\"year\", { limit: 5 });\n  }\n  useEffect(() => {\n    if (!type) {\n      setType(state.data && state.data.type);\n    }\n    if (!genres) {\n      setGenres(state.data && state.data.genre);\n    }\n    if (!nation) {\n      setNation(state.data && state.data.nation);\n    }\n    if (!year) {\n      setYear(state.data && state.data.year);\n    }\n    console.log(params)\n    if (type && genres && nation && year && params && reset) {\n      var aCondition = []; var aBreadcrumb = [];\n      if (params.type && params.type != 'all-type') {\n        let obj = _.find(type, { id: params.type });\n        if (obj) {\n          aCondition.push([\"type\", obj])\n          aBreadcrumb.push({ url: `/${obj.id}`, label: obj.name })\n        }\n      }\n      if (params.genre && params.genre != 'all-genre') {\n        let obj = _.find(genres, { id: params.genre });\n        if (obj) {\n          aCondition.push([\"genre\", obj])\n          aBreadcrumb.push({ url: `/the-loai/${obj.id}`, label: obj.name })\n        }\n      }\n      if (params.nation && params.nation != 'all-nation') {\n        let obj = _.find(nation, { id: params.nation });\n        if (obj) {\n          aCondition.push([\"nation\", obj])\n          aBreadcrumb.push({ url: `/quoc-gia/${obj.id}`, label: obj.name })\n        }\n      }\n      if (params.year && params.year != 'all-year') {\n        aCondition.push([\"year\", params.year])\n        aBreadcrumb.push({ url: `/phim-nam/${params.year}`, label: `Phim ${params.year}` })\n      }\n      if (aCondition.length) {\n        firebase.getDocWithMultiCondition(\"movie\", { where: aCondition, orderBy: [\"createdAt\", \"desc\"], limit: 10 }, setFilter);\n        reset = false;\n      }\n      setBreadcrumb(aBreadcrumb);\n    }\n    if (keyword && reset) {\n      firebase.getDocWithKeyword(\"movie\", {\n        where: [\n          [`keywords CONTAINS '${props.match.params.keyword.replace(/ /g, \"%20\")}'`],\n          [`tags CONTAINS '${props.match.params.keyword.replace(/ /g, \"%20\")}'`]\n        ]\n      }, setFilter);\n      reset = false;\n    }\n  })\n  // console.log(\"RESET\",reset)\n  // console.log(\"filterf\",filter)\n  if (!reset && filter) {\n    console.log(filter)\n    $(\".main-page\").addClass(\"fadeIn\");\n    $(\".zmoto-products\").addClass(\"fadeIn\");\n  }\n  return (\n    <div id=\"MoviePage\" className=\"main-page fadeOut\">\n      {/* <!-- breadcroumb-area --> */}\n      {\n        props.match.params.keyword ? <Breadcrumbs items={[`Từ khóa: ${props.match.params.keyword}`]} /> : <Breadcrumbs items={breadcrumb} />\n      }\n      {/* <!-- End breadcroumb-area --> */}\n      <div className=\"zmoto-inner-page\">\n        <div className=\"zmovo-product-page\">\n          <div className=\"container\">\n            <div className=\"zmovo-product-items\">\n              <div className=\"zmovo-product-items-inner\">\n                <div className=\"row\">\n                  <div className=\"col-12\">\n                    <div className=\"zmovo-product-with-sedbar\">\n                      <div className=\"row\">\n                        {/* <!-- Right --> */}\n                        <div className=\"col-lg-9\">\n                          {/* <!-- Product Filter --> */}\n                          <div className=\"product-filter mb-30\">\n                            <div className=\"product-filter-inner\">\n                              <div className=\"product-filter-list\">\n                                <div className=\"short-by-show form-inline2\">\n                                  <div className=\"row\">\n                                    <div className=\"col-6 col-sm-4 col-md-3 col-lg-2\">\n                                      <div className=\"short-by\">\n                                        <select type=\"select\" id=\"sort\" onChange={onSort} className=\"selectpicker\" data-live-search=\"true\">\n                                          <option value=\"\" hidden>Sắp xếp</option>\n                                          <option value=\"createdAt\">Mới nhất</option>\n                                          <option value=\"imdb\">Top IMDb</option>\n                                          <option value=\"view\">Lượt xem</option>\n                                          <option value=\"rating\">Top đánh giá</option>\n                                        </select>\n                                      </div>\n                                    </div>\n                                    {\n                                      type ? (\n                                        <div className=\"col-6 col-sm-4 col-md-3 col-lg-2\">\n                                          <div className=\"pro-show\">\n                                            <select type=\"select\" id=\"type\" className=\"selectpicker\" defaultValue={params && params.type}>\n                                              <option value=\"all-type\">--Loại--</option>\n                                              {\n                                                type.map(function (item, key) {\n                                                  return <option key={key} value={item.id}>{item.name}</option>\n                                                })\n                                              }\n                                            </select>\n                                          </div>\n                                        </div>\n                                      ) : \"\"\n                                    }\n                                    {\n                                      genres ? (\n                                        <div className=\"col-6 col-sm-4 col-md-3 col-lg-2\">\n                                          <div className=\"pro-show\">\n                                            <select type=\"select\" id=\"genre\" className=\"selectpicker\" defaultValue={params && params.genre ? params.genre : props.match.params.genre || 0} >\n                                              <option value=\"all-genre\">--Thể loại--</option>\n                                              {\n                                                genres.map(function (item, key) {\n                                                  return <option key={key} value={item.id}>{item.name}</option>\n                                                })\n                                              }\n                                            </select>\n                                          </div>\n                                        </div>\n                                      ) : \"\"\n                                    }\n                                    {nation ? (\n                                      <div className=\"col-6 col-sm-4 col-md-3 col-lg-2\">\n                                        <div className=\"pro-show\">\n                                          <select type=\"select\" id=\"nation\" className=\"selectpicker\" defaultValue={params && params.nation ? params.nation : props.match.params.nation || 0} >\n                                            <option value=\"all-nation\">--Quốc gia--</option>\n                                            {\n                                              nation.map(function (item, key) {\n                                                return <option key={key} value={item.id}>{item.name}</option>\n                                              })\n                                            }\n                                          </select>\n                                        </div>\n                                      </div>\n                                    ) : \"\"}\n                                    {year ? (\n                                      <div className=\"col-6 col-sm-4 col-md-3 col-lg-2\">\n                                        <div className=\"pro-show\">\n                                          <select type=\"select\" id=\"year\" className=\"selectpicker\" defaultValue={params && params.year ? params.year : props.match.params.year} >\n                                            <option value=\"all-year\">--Năm--</option>\n                                            {\n                                              year.map(function (item, key) {\n                                                return <option key={key} value={item.id}>{item.id}</option>\n                                              })\n                                            }\n                                          </select>\n                                        </div>\n                                      </div>\n                                    ) : \"\"}\n                                    <div className=\"col-6 col-sm-4 col-md-3 col-lg-2\">\n                                      <div className=\"pro-show\">\n                                        <button className=\"btn btn-buttons btn-sm btn-fit\" onClick={onFilter}>Lọc phim</button>\n                                      </div>\n                                    </div>\n                                  </div>\n                                </div>\n                              </div>\n                            </div>\n                          </div>\n                          {/* <!-- end Product Filter --> */}\n                          <div className=\"zmoto-products fadeOut\">\n                            <div className=\"zmovo-product-list\">\n                              <div className=\"row\">\n                                {/* <!-- ITEM --> */}\n                                {filter && filter.map(function (item, key) {\n                                  return (\n                                    <div key={key} className=\"col-lg-3 col-md-4 col-xs-6\">\n                                      <div className=\"item\" >\n                                        <VideoItem data={item} />\n                                      </div>\n                                    </div>\n                                  )\n                                })}\n                              </div>\n                            </div>\n                          </div>\n                          {/* <!-- Product Filter --> */}\n                          <div className=\"product-filter\">\n                            <div className=\"product-filter-inner\">\n                              <div className=\"product-filter-list\">\n                                <div className=\"pagination-wrapper\">\n                                  \n\n                                  <nav aria-label=\"navigations\">\n                                      {/* <ul className=\"pagination\">\n                                        <li className=\"page-item\"><a className=\"page-link pagefirst\" href=\"/\"><i className=\"fa fa-angle-left\"></i></a></li>\n                                        <li className=\"page-item active\"><a className=\"page-link\" href=\"/\">2</a></li>\n                                        <li className=\"page-item\"><a className=\"page-link lastpage\" href=\"/\"><i className=\"fa fa-angle-right\"></i></a></li>\n                                      </ul> */}\n                                    <ReactPaginate\n                                    previousLabel={'<'}\n                                    nextLabel={'>'}\n                                    previousClassName={'page-item'}\n                                    nextClassName={'page-item'}\n                                    previousLinkClassName={'page-link pagefirst'}\n                                    nextLinkClassName={'page-link lastpage'}\n                                    breakLabel={'...'}\n                                    breakClassName={'page-item break-me'}\n                                    containerClassName={'pagination'}\n                                    pageClassName={'page-item'}\n                                    pageLinkClassName={'page-link'}\n                                    activeClassName={'active'}\n                                    pageCount={filter && filter.length/4}\n                                    marginPagesDisplayed={2}\n                                    pageRangeDisplayed={5}\n                                    onPageChange={onChangePage}\n                                  />\n                                  </nav>\n                                </div>\n                              </div>\n                            </div>\n                          </div>\n                          {/* <!-- end Product Filter --> */}\n                        </div>\n                        {/* <!-- End Right --> */}\n                        {/* <!-- Left --> */}\n                        <div className=\"col-lg-3\">\n                          <SideBar />\n                        </div>\n                        {/* <!-- End Left --> */}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}