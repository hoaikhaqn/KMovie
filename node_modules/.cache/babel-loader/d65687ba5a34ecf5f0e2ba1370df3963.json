{"ast":null,"code":"import _slicedToArray from \"/home/h/Source/Project/movie-website/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/h/Source/Project/movie-website/src/views/Movies/index.js\";\nimport React, { useEffect, useState } from \"react\";\nimport ReactPaginate from 'react-paginate';\nimport { useReduceState } from \"../../context\";\nimport \"./style.css\";\nimport $ from \"jquery\"; //Components\n\nimport Breadcrumbs from \"../../containers/DefaultLayout/DefaultBreadcrumbs\";\nimport SideBar from \"../../components/Sidebar\";\nimport MovieList from \"./MovieList\";\nimport MovieFilter from \"./MovieFilter\";\n\nvar _ = require('lodash');\n\nvar reset = false;\nexport default function MoviePage(props) {\n  const _useReduceState = useReduceState(),\n        state = _useReduceState.state,\n        firebase = _useReduceState.firebase,\n        getCollection = _useReduceState.getCollection;\n\n  const _useState = useState(),\n        _useState2 = _slicedToArray(_useState, 2),\n        type = _useState2[0],\n        setType = _useState2[1];\n\n  const _useState3 = useState(),\n        _useState4 = _slicedToArray(_useState3, 2),\n        genre = _useState4[0],\n        setGenre = _useState4[1];\n\n  const _useState5 = useState(),\n        _useState6 = _slicedToArray(_useState5, 2),\n        nation = _useState6[0],\n        setNation = _useState6[1];\n\n  const _useState7 = useState(),\n        _useState8 = _slicedToArray(_useState7, 2),\n        year = _useState8[0],\n        setYear = _useState8[1];\n\n  const _useState9 = useState(),\n        _useState10 = _slicedToArray(_useState9, 2),\n        params = _useState10[0],\n        setParams = _useState10[1];\n\n  const _useState11 = useState(),\n        _useState12 = _slicedToArray(_useState11, 2),\n        keyword = _useState12[0],\n        setKeyword = _useState12[1];\n\n  const _useState13 = useState(),\n        _useState14 = _slicedToArray(_useState13, 2),\n        filter = _useState14[0],\n        setFilter = _useState14[1];\n\n  const _useState15 = useState(),\n        _useState16 = _slicedToArray(_useState15, 2),\n        dataPage = _useState16[0],\n        setDataPage = _useState16[1];\n\n  const _useState17 = useState(),\n        _useState18 = _slicedToArray(_useState17, 2),\n        breadcrumb = _useState18[0],\n        setBreadcrumb = _useState18[1];\n\n  const _useState19 = useState(),\n        _useState20 = _slicedToArray(_useState19, 2),\n        pages = _useState20[0],\n        setPages = _useState20[1];\n\n  const _useState21 = useState(),\n        _useState22 = _slicedToArray(_useState21, 2),\n        currentPage = _useState22[0],\n        setCurrentPage = _useState22[1];\n\n  const perPage = 4;\n\n  const onChangePage = data => {\n    setCurrentPage(data.selected);\n    let dataUpdated = getDataPage(filter, data.selected);\n    setDataPage(dataUpdated);\n  };\n\n  const getDataPage = (data, currentPage) => {\n    let dataUpdated = [];\n    let page = Math.ceil(currentPage * perPage);\n\n    for (let i = page; i < (page + perPage - 1 < data.length ? page + perPage : data.length); i++) {\n      dataUpdated.push(data[i]);\n    }\n\n    return dataUpdated;\n  };\n\n  if (!keyword && props.match.params.keyword) {\n    reset = true;\n    $(\".zmoto-products\").removeClass(\"fadeIn\");\n    setKeyword(props.match.params.keyword);\n  }\n\n  if (!params || !_.isEqual(params, props.match.params)) {\n    reset = true;\n    $(\".zmoto-products\").removeClass(\"fadeIn\");\n    setParams(props.match.params);\n  }\n\n  if (!state.data || state.data && !state.data.year) {\n    getCollection(\"year\", {\n      limit: 5\n    });\n  }\n\n  useEffect(() => {\n    if (state.data) {\n      if (!type && state.data.type) {\n        setType(state.data.type);\n      }\n\n      if (!genre && state.data.genre) {\n        setGenre(state.data.genre);\n      }\n\n      if (!nation && state.data.nation) {\n        setNation(state.data.nation);\n      }\n\n      if (!year && state.data.year) {\n        setYear(state.data.year);\n      }\n    }\n\n    if (type && genre && nation && year && params && reset) {\n      var aCondition = [];\n      var aBreadcrumb = [];\n\n      if (params.type && params.type !== 'all-type') {\n        let obj = _.find(type, {\n          id: params.type\n        });\n\n        if (obj) {\n          aCondition.push([\"type\", obj]);\n          aBreadcrumb.push({\n            url: \"/\".concat(obj.id),\n            label: obj.name\n          });\n        }\n      }\n\n      if (params.genre && params.genre !== 'all-genre') {\n        let obj = _.find(genre, {\n          id: params.genre\n        });\n\n        if (obj) {\n          aCondition.push([\"genre\", obj]);\n          aBreadcrumb.push({\n            url: \"/the-loai/\".concat(obj.id),\n            label: obj.name\n          });\n        }\n      }\n\n      if (params.nation && params.nation !== 'all-nation') {\n        let obj = _.find(nation, {\n          id: params.nation\n        });\n\n        if (obj) {\n          aCondition.push([\"nation\", obj]);\n          aBreadcrumb.push({\n            url: \"/quoc-gia/\".concat(obj.id),\n            label: obj.name\n          });\n        }\n      }\n\n      if (params.year && params.year !== 'all-year') {\n        aCondition.push([\"year\", params.year]);\n        aBreadcrumb.push({\n          url: \"/phim-nam/\".concat(params.year),\n          label: \"Phim \".concat(params.year)\n        });\n      }\n\n      if (aCondition.length) {\n        firebase.getDocWithMultiCondition(\"movie\", {\n          where: aCondition,\n          orderBy: [\"createdAt\", \"desc\"]\n        }, data => {\n          const dataUpdated = getDataPage(data, 0);\n          setDataPage(dataUpdated);\n          setFilter(data);\n        });\n        reset = false;\n      }\n\n      setBreadcrumb(aBreadcrumb);\n    }\n\n    if (keyword && reset) {\n      firebase.getDocWithKeyword(\"movie\", {\n        where: [[\"keywords CONTAINS '\".concat(props.match.params.keyword.replace(/ /g, \"%20\"), \"'\")], [\"tags CONTAINS '\".concat(props.match.params.keyword.replace(/ /g, \"%20\"), \"'\")]]\n      }, data => {\n        const dataUpdated = getDataPage(data, 0);\n        setDataPage(dataUpdated);\n        setFilter(data);\n      });\n      reset = false;\n    }\n  }, [state.data, type, genre, nation, year, params, keyword, firebase, props.match.params.keyword]);\n\n  if (!reset && filter) {\n    // console.log(reset)\n    $(\".main-page\").addClass(\"fadeIn\");\n    $(\".zmoto-products\").addClass(\"fadeIn\");\n  }\n\n  if (!reset && !pages && filter) {\n    setPages(filter.length / perPage);\n  }\n\n  return React.createElement(\"div\", {\n    id: \"MoviePage\",\n    className: \"main-page fadeOut\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132\n    },\n    __self: this\n  }, props.match.params.keyword ? React.createElement(Breadcrumbs, {\n    items: [\"T\\u1EEB kh\\xF3a: \".concat(props.match.params.keyword)],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  }) : React.createElement(Breadcrumbs, {\n    items: breadcrumb,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"zmoto-inner-page\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"zmovo-product-page\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"zmovo-product-items\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"zmovo-product-items-inner\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"row\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col-12\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"zmovo-product-with-sedbar\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"row\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col-lg-9\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148\n    },\n    __self: this\n  }, React.createElement(MovieFilter, {\n    params: params,\n    type: type,\n    genre: genre,\n    nation: nation,\n    year: year,\n    filter: filter,\n    history: props.history,\n    setFilter: setFilter,\n    currentPage: currentPage,\n    setCurrentPage: setCurrentPage,\n    getDataPage: getDataPage,\n    setDataPage: setDataPage,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"zmoto-products fadeOut\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165\n    },\n    __self: this\n  }, React.createElement(MovieList, {\n    data: dataPage,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166\n    },\n    __self: this\n  })), filter && filter.length > perPage ? React.createElement(\"div\", {\n    className: \"product-filter\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"product-filter-inner\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"product-filter-list\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"pagination-wrapper\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174\n    },\n    __self: this\n  }, React.createElement(\"nav\", {\n    \"aria-label\": \"navigations\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175\n    },\n    __self: this\n  }, React.createElement(ReactPaginate, {\n    previousLabel: '<',\n    nextLabel: '>',\n    previousClassName: 'page-item',\n    nextClassName: 'page-item',\n    previousLinkClassName: 'page-link pagefirst',\n    nextLinkClassName: 'page-link lastpage',\n    breakLabel: '...',\n    breakClassName: 'page-item break-me',\n    containerClassName: 'pagination',\n    pageClassName: 'page-item',\n    pageLinkClassName: 'page-link',\n    activeClassName: 'active',\n    pageCount: pages,\n    forcePage: currentPage,\n    marginPagesDisplayed: 2,\n    pageRangeDisplayed: 5,\n    onPageChange: onChangePage,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176\n    },\n    __self: this\n  })))))) : \"\"), React.createElement(\"div\", {\n    className: \"col-lg-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206\n    },\n    __self: this\n  }, React.createElement(SideBar, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207\n    },\n    __self: this\n  }))))))))))));\n}","map":{"version":3,"sources":["/home/h/Source/Project/movie-website/src/views/Movies/index.js"],"names":["React","useEffect","useState","ReactPaginate","useReduceState","$","Breadcrumbs","SideBar","MovieList","MovieFilter","_","require","reset","MoviePage","props","state","firebase","getCollection","type","setType","genre","setGenre","nation","setNation","year","setYear","params","setParams","keyword","setKeyword","filter","setFilter","dataPage","setDataPage","breadcrumb","setBreadcrumb","pages","setPages","currentPage","setCurrentPage","perPage","onChangePage","data","selected","dataUpdated","getDataPage","page","Math","ceil","i","length","push","match","removeClass","isEqual","limit","aCondition","aBreadcrumb","obj","find","id","url","label","name","getDocWithMultiCondition","where","orderBy","getDocWithKeyword","replace","addClass","history"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport ReactPaginate from 'react-paginate';\nimport { useReduceState } from \"../../context\";\nimport \"./style.css\";\nimport $ from \"jquery\";\n\n//Components\nimport Breadcrumbs from \"../../containers/DefaultLayout/DefaultBreadcrumbs\";\nimport SideBar from \"../../components/Sidebar\";\nimport MovieList from \"./MovieList\";\nimport MovieFilter from \"./MovieFilter\";\n\nvar _ = require('lodash');\nvar reset = false;\nexport default function MoviePage(props) {\n  const { state, firebase, getCollection } = useReduceState();\n  const [type, setType] = useState();\n  const [genre, setGenre] = useState();\n  const [nation, setNation] = useState();\n  const [year, setYear] = useState();\n  const [params, setParams] = useState();\n  const [keyword, setKeyword] = useState();\n  const [filter, setFilter] = useState();\n  const [dataPage, setDataPage] = useState();\n  const [breadcrumb, setBreadcrumb] = useState();\n  const [pages, setPages] = useState();\n  const [currentPage, setCurrentPage] = useState();\n  const perPage = 4;\n\n  const onChangePage = data => {\n    setCurrentPage(data.selected);\n    let dataUpdated = getDataPage(filter,data.selected);\n    setDataPage(dataUpdated);\n  }\n\n  const getDataPage = (data,currentPage) => {\n    let dataUpdated = []; let page = Math.ceil(currentPage * perPage);\n    for (let i = page; i < (page + perPage - 1 < data.length ? page + perPage : data.length); i++) {\n      dataUpdated.push(data[i]);\n    }\n    return dataUpdated;\n  }\n  if (!keyword && props.match.params.keyword) {\n    reset = true;\n    $(\".zmoto-products\").removeClass(\"fadeIn\");\n    setKeyword(props.match.params.keyword);\n  }\n  if (!params || !_.isEqual(params, props.match.params)) {\n    reset = true;\n    $(\".zmoto-products\").removeClass(\"fadeIn\");\n    setParams(props.match.params);\n  }\n\n  if (!state.data || (state.data && !state.data.year)) {\n    getCollection(\"year\", { limit: 5 });\n  }\n  useEffect(() => {\n    if(state.data){\n      if (!type && state.data.type) {\n        setType(state.data.type);\n      }\n      if (!genre && state.data.genre) {\n        setGenre(state.data.genre);\n      }\n      if (!nation && state.data.nation) {\n        setNation(state.data.nation);\n      }\n      if (!year && state.data.year) {\n        setYear(state.data.year);\n      }\n    }\n    if (type && genre && nation && year && params && reset) {\n      var aCondition = []; var aBreadcrumb = [];\n      if (params.type && params.type !== 'all-type') {\n        let obj = _.find(type, { id: params.type });\n        if (obj) {\n          aCondition.push([\"type\", obj])\n          aBreadcrumb.push({ url: `/${obj.id}`, label: obj.name })\n        }\n      }\n      if (params.genre && params.genre !== 'all-genre') {\n        let obj = _.find(genre, { id: params.genre });\n        if (obj) {\n          aCondition.push([\"genre\", obj])\n          aBreadcrumb.push({ url: `/the-loai/${obj.id}`, label: obj.name })\n        }\n      }\n      if (params.nation && params.nation !== 'all-nation') {\n        let obj = _.find(nation, { id: params.nation });\n        if (obj) {\n          aCondition.push([\"nation\", obj])\n          aBreadcrumb.push({ url: `/quoc-gia/${obj.id}`, label: obj.name })\n        }\n      }\n      if (params.year && params.year !== 'all-year') {\n        aCondition.push([\"year\", params.year])\n        aBreadcrumb.push({ url: `/phim-nam/${params.year}`, label: `Phim ${params.year}` })\n      }\n      if (aCondition.length) {\n        firebase.getDocWithMultiCondition(\"movie\", { where: aCondition, orderBy: [\"createdAt\", \"desc\"]},(data)=>{\n          const dataUpdated = getDataPage(data, 0);\n          setDataPage(dataUpdated);\n          setFilter(data)\n        });\n        reset = false;\n      }\n      setBreadcrumb(aBreadcrumb);\n    }\n    if (keyword && reset) {\n      firebase.getDocWithKeyword(\"movie\", {\n        where: [\n          [`keywords CONTAINS '${props.match.params.keyword.replace(/ /g, \"%20\")}'`],\n          [`tags CONTAINS '${props.match.params.keyword.replace(/ /g, \"%20\")}'`]\n        ]\n      },(data)=>{\n        const dataUpdated = getDataPage(data, 0);\n        setDataPage(dataUpdated);\n        setFilter(data)\n      });\n      reset = false;\n    }\n  },[state.data, type, genre, nation, year, params, keyword, firebase, props.match.params.keyword])\n  if (!reset && filter) {\n    // console.log(reset)\n    $(\".main-page\").addClass(\"fadeIn\");\n    $(\".zmoto-products\").addClass(\"fadeIn\");\n  }\n  if (!reset && !pages && filter) {\n    setPages(filter.length / perPage);\n  }\n  return (\n    <div id=\"MoviePage\" className=\"main-page fadeOut\">\n      {/* <!-- breadcroumb-area --> */}\n      {\n        props.match.params.keyword ? <Breadcrumbs items={[`Từ khóa: ${props.match.params.keyword}`]} /> : <Breadcrumbs items={breadcrumb} />\n      }\n      {/* <!-- End breadcroumb-area --> */}\n      <div className=\"zmoto-inner-page\">\n        <div className=\"zmovo-product-page\">\n          <div className=\"container\">\n            <div className=\"zmovo-product-items\">\n              <div className=\"zmovo-product-items-inner\">\n                <div className=\"row\">\n                  <div className=\"col-12\">\n                    <div className=\"zmovo-product-with-sedbar\">\n                      <div className=\"row\">\n                        {/* <!-- Right --> */}\n                        <div className=\"col-lg-9\">\n                          {/* <!-- Product Filter --> */}\n                          <MovieFilter\n                            params={params}\n                            type={type}\n                            genre={genre}\n                            nation={nation}\n                            year={year}\n                            filter={filter}\n                            history={props.history}\n                            setFilter={setFilter}\n                            currentPage={currentPage}\n                            setCurrentPage={setCurrentPage}\n                            getDataPage={getDataPage}\n                            setDataPage={setDataPage}\n                          />\n                          {/* <!-- end Product Filter --> */}\n                          <div className=\"zmoto-products fadeOut\">\n                            <MovieList data={dataPage} />\n                          </div>\n                          {/* <!-- Product Filter --> */}\n                          {\n                            (filter && filter.length > perPage) ? (\n                              <div className=\"product-filter\">\n                                <div className=\"product-filter-inner\">\n                                  <div className=\"product-filter-list\">\n                                    <div className=\"pagination-wrapper\">\n                                      <nav aria-label=\"navigations\">\n                                        <ReactPaginate\n                                          previousLabel={'<'}\n                                          nextLabel={'>'}\n                                          previousClassName={'page-item'}\n                                          nextClassName={'page-item'}\n                                          previousLinkClassName={'page-link pagefirst'}\n                                          nextLinkClassName={'page-link lastpage'}\n                                          breakLabel={'...'}\n                                          breakClassName={'page-item break-me'}\n                                          containerClassName={'pagination'}\n                                          pageClassName={'page-item'}\n                                          pageLinkClassName={'page-link'}\n                                          activeClassName={'active'}\n                                          pageCount={pages}\n                                          forcePage={currentPage}\n                                          marginPagesDisplayed={2}\n                                          pageRangeDisplayed={5}\n                                          onPageChange={onChangePage}\n                                        />\n                                      </nav>\n                                    </div>\n                                  </div>\n                                </div>\n                              </div>\n                            ): \"\"\n                          }\n                          {/* <!-- end Product Filter --> */}\n                        </div>\n                        {/* <!-- End Right --> */}\n                        {/* <!-- Left --> */}\n                        <div className=\"col-lg-3\">\n                          <SideBar />\n                        </div>\n                        {/* <!-- End Left --> */}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}